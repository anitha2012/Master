<script>

	var updateUserData = function()
		{
			//alert('updating user data');
			"ui-dialog-titlebar-close".$().click();
			"saveMessage".$().html("data saved");
			updateUser("userId".$().html(),
						"email".$().val(),
						"firstName".$().val(),
						"lastName".$().val());
					
		}
		
	var loadCurrentUserDataAndOpenDialog = function(data)
		{
			var userData = data.d;
			//alert(JSON.stringify(data.d));
			//alert(userData.UserName);
			"userName".$().html(userData.UserName);
			"userId".$().html(userData.UserID);
			"email".$().val(userData.EMail);
			"firstName".$().val(userData.FirstName)
			"lastName".$().val(userData.LastName);
			openDialog(); 
		}	
		
	var openDialog = function()
		{			
			"updateCurrentUserData".$().dialog("open").dialog( { 
											title: "Update Current User Data" , 
											width: '440px',
											modal : true,
											buttons	: { 	
														//"Cancel" : cancelNewLibraryCreation,
														"Update" : updateUserData
													  }
										  } );	
			
		}
		
	$(document).ready(								
				function()  {	
								loadCurrentUserDataAndOpenDialog(TM.Gui.CurrentUser.userData);
								//openDialog();
							});
</script>

<div id="updateCurrentUserData">
	<span style="display:inline-block;width:100px;">Username:</span>
	<label id="userName"  /> ( <label id="userId"  />)<br />
	<span style="display:inline-block;width:100px;">Email:</span>
	<input  type="text" id="email" class="otherTextBox" style="width:300px;" /><br />
	<span style="display:inline-block;width:100px;">First Name:</span>
	<input  type="text" id="firstName" class="otherTextBox" style="width:300px;" /><br />
	<span style="display:inline-block;width:100px;">Last Name:</span>
	<input  type="text" id="lastName" class="otherTextBox" style="width:300px;" /><br />
	
	
</div>
<div id="saveMessage"></div>